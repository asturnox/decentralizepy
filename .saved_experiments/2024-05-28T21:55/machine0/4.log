[2024-05-28 21:55:56,315][DPSGDNode][DEBUG] Rank: 4
[2024-05-28 21:55:56,315][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,315][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,418][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,029][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,070][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,074][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,076][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,105][Node][DEBUG] Sending connection request to 6
[2024-05-28 21:56:00,105][TCP][DEBUG] Connecting to my neighbour: 6
[2024-05-28 21:56:00,106][TCP][DEBUG] 4 sent the message to 6.
[2024-05-28 21:56:00,106][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,106][Node][DEBUG] Waiting HELLO from 6
[2024-05-28 21:56:00,229][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,229][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,229][Node][DEBUG] Waiting HELLO from 6
[2024-05-28 21:56:00,730][Node][DEBUG] Received some message from 6 with CHANNEL: CONNECT
[2024-05-28 21:56:00,730][Node][DEBUG] Received HELLO from 6
[2024-05-28 21:56:00,731][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,731][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,731][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,731][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:00,731][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,732][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:00,785][Training][DEBUG] Round: 1 loss: 2.523714303970337
[2024-05-28 21:56:00,804][Training][DEBUG] Round: 2 loss: 2.926091432571411
[2024-05-28 21:56:00,820][Training][DEBUG] Round: 3 loss: 2.9071659247080484
[2024-05-28 21:56:00,821][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,822][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:00,822][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,879][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,879][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {6}
[2024-05-28 21:56:00,879][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:00,885][Sharing][DEBUG] Model sending this round: [-0.07373591  0.05270962 -0.03058717 ... -0.00475578  0.00634999
 -0.01125546]
[2024-05-28 21:56:00,887][TCP][DEBUG] 4 sent the message to 6.
[2024-05-28 21:56:00,887][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:00,887][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,022][Node][DEBUG] Received some message from 6 with CHANNEL: DPSGD
[2024-05-28 21:56:01,022][DPSGDNode][DEBUG] Received Model from 6 of iteration 0
[2024-05-28 21:56:01,022][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,022][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,022][Sharing][DEBUG] Averaging model from neighbor 6 of iteration 0
[2024-05-28 21:56:01,026][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,026][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,026][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,028][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:01,062][Training][DEBUG] Round: 1 loss: 1.9573637247085571
[2024-05-28 21:56:01,097][Training][DEBUG] Round: 2 loss: 2.405763328075409
[2024-05-28 21:56:01,130][Training][DEBUG] Round: 3 loss: 2.6308970053990683
[2024-05-28 21:56:01,130][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,131][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:01,131][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,148][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,148][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,148][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,177][Sharing][DEBUG] Model sending this round: [-0.0727489   0.05298862 -0.03092822 ... -0.00333306  0.00700445
 -0.01109164]
[2024-05-28 21:56:01,177][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,177][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,177][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,178][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,178][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,178][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,178][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,216][Training][DEBUG] Round: 1 loss: 2.727008104324341
[2024-05-28 21:56:01,243][Training][DEBUG] Round: 2 loss: 2.646314024925232
[2024-05-28 21:56:01,283][Training][DEBUG] Round: 3 loss: 2.717719872792562
[2024-05-28 21:56:01,284][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,285][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:01,285][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,294][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,294][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,294][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,294][Sharing][DEBUG] Model sending this round: [-0.07315922  0.05283982 -0.0310873  ... -0.00682723  0.00953733
 -0.01270314]
[2024-05-28 21:56:01,294][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,295][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,295][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,295][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,295][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,295][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,296][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,334][Training][DEBUG] Round: 1 loss: 2.4087557792663574
[2024-05-28 21:56:01,375][Training][DEBUG] Round: 2 loss: 2.144390642642975
[2024-05-28 21:56:01,403][Training][DEBUG] Round: 3 loss: 2.425705313682556
[2024-05-28 21:56:01,404][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,404][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:01,404][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,414][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,414][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,415][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,416][Sharing][DEBUG] Model sending this round: [-0.0734052   0.0526682  -0.03122087 ... -0.0063177   0.00590763
 -0.01301578]
[2024-05-28 21:56:01,416][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,416][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,416][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,416][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,417][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,417][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,417][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,439][Training][DEBUG] Round: 1 loss: 2.712987184524536
[2024-05-28 21:56:01,469][Training][DEBUG] Round: 2 loss: 2.6855669021606445
[2024-05-28 21:56:01,498][Training][DEBUG] Round: 3 loss: 2.502563953399658
[2024-05-28 21:56:01,498][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,498][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:01,498][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,510][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,511][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,511][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,511][Sharing][DEBUG] Model sending this round: [-0.07306974  0.05293934 -0.03100087 ... -0.0049245   0.00571913
 -0.01315855]
[2024-05-28 21:56:01,511][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,511][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,511][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,512][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,512][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,513][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,513][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,544][Training][DEBUG] Round: 1 loss: 2.0876216888427734
[2024-05-28 21:56:01,643][Training][DEBUG] Round: 2 loss: 2.2833826541900635
[2024-05-28 21:56:01,676][Training][DEBUG] Round: 3 loss: 2.2775628566741943
[2024-05-28 21:56:01,678][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,679][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:01,679][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,690][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,691][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {1}
[2024-05-28 21:56:01,691][Node][DEBUG] Sending connection request to 1
[2024-05-28 21:56:01,692][TCP][DEBUG] Connecting to my neighbour: 1
[2024-05-28 21:56:01,696][TCP][DEBUG] 4 sent the message to 1.
[2024-05-28 21:56:01,696][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,697][Node][DEBUG] Waiting HELLO from 1
[2024-05-28 21:56:01,838][Node][DEBUG] Received some message from 1 with CHANNEL: CONNECT
[2024-05-28 21:56:01,838][Node][DEBUG] Received HELLO from 1
[2024-05-28 21:56:01,849][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,852][Sharing][DEBUG] Model sending this round: [-0.07289761  0.05317888 -0.03086033 ... -0.00511742  0.00629697
 -0.01232206]
[2024-05-28 21:56:01,853][TCP][DEBUG] 4 sent the message to 1.
[2024-05-28 21:56:01,853][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,854][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,854][Node][DEBUG] Received some message from 1 with CHANNEL: DPSGD
[2024-05-28 21:56:01,855][DPSGDNode][DEBUG] Received Model from 1 of iteration 5
[2024-05-28 21:56:01,855][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,856][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,856][Sharing][DEBUG] Averaging model from neighbor 1 of iteration 5
[2024-05-28 21:56:01,860][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,860][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,861][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,863][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,885][Training][DEBUG] Round: 1 loss: 2.114612102508545
[2024-05-28 21:56:01,922][Training][DEBUG] Round: 2 loss: 2.4328731298446655
[2024-05-28 21:56:01,997][Training][DEBUG] Round: 3 loss: 2.538987318674723
[2024-05-28 21:56:01,997][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,997][TCP][DEBUG] 4 sent the message to -1.
[2024-05-28 21:56:01,997][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,997][Node][DEBUG] Received some message from 10 with CHANNEL: CONNECT
[2024-05-28 21:56:01,997][Node][DEBUG] Received some message from 8 with CHANNEL: CONNECT
[2024-05-28 21:56:02,006][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:02,006][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {10}
[2024-05-28 21:56:02,006][Node][DEBUG] Sending connection request to 10
[2024-05-28 21:56:02,006][TCP][DEBUG] Connecting to my neighbour: 10
[2024-05-28 21:56:02,007][TCP][DEBUG] 4 sent the message to 10.
[2024-05-28 21:56:02,007][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:02,012][Node][DEBUG] Waiting HELLO from 10
[2024-05-28 21:56:02,012][Node][DEBUG] Received HELLO from 10
[2024-05-28 21:56:02,012][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:02,012][Sharing][DEBUG] Model sending this round: [-0.07330707  0.0524573  -0.03108231 ... -0.00378693  0.00490099
 -0.01069986]
[2024-05-28 21:56:02,013][TCP][DEBUG] 4 sent the message to 10.
[2024-05-28 21:56:02,013][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:02,013][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:02,013][Node][DEBUG] Received some message from 10 with CHANNEL: DPSGD
[2024-05-28 21:56:02,013][DPSGDNode][DEBUG] Received Model from 10 of iteration 6
[2024-05-28 21:56:02,013][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:02,013][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:02,013][Sharing][DEBUG] Averaging model from neighbor 10 of iteration 6
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:02,014][DPSGDNode][INFO] Starting training iteration: 7
