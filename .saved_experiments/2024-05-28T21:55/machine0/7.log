[2024-05-28 21:55:56,482][DPSGDNode][DEBUG] Rank: 7
[2024-05-28 21:55:56,483][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,483][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,687][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,510][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,551][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,460][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,461][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,494][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,494][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,494][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,494][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:00,495][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,495][Node][DEBUG] Waiting HELLO from -1
[2024-05-28 21:56:00,564][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,564][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,565][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:00,606][Training][DEBUG] Round: 1 loss: 2.639798879623413
[2024-05-28 21:56:00,629][Training][DEBUG] Round: 2 loss: 2.893812417984009
[2024-05-28 21:56:00,648][Training][DEBUG] Round: 3 loss: 2.9063883622487388
[2024-05-28 21:56:00,648][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,648][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:00,649][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,869][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,870][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:00,870][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:00,876][Sharing][DEBUG] Model sending this round: [-0.07418071  0.05203201 -0.03120046 ... -0.00664359  0.00744138
 -0.01231695]
[2024-05-28 21:56:00,876][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:00,876][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:00,876][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:00,877][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:00,877][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:00,877][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:00,878][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:00,947][Training][DEBUG] Round: 1 loss: 3.0271480083465576
[2024-05-28 21:56:00,979][Training][DEBUG] Round: 2 loss: 2.6722077131271362
[2024-05-28 21:56:01,016][Training][DEBUG] Round: 3 loss: 2.545934041341146
[2024-05-28 21:56:01,017][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,018][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:01,018][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,018][Node][DEBUG] Received some message from 0 with CHANNEL: CONNECT
[2024-05-28 21:56:01,040][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,040][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {0}
[2024-05-28 21:56:01,040][Node][DEBUG] Sending connection request to 0
[2024-05-28 21:56:01,040][TCP][DEBUG] Connecting to my neighbour: 0
[2024-05-28 21:56:01,044][TCP][DEBUG] 7 sent the message to 0.
[2024-05-28 21:56:01,044][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,044][Node][DEBUG] Waiting HELLO from 0
[2024-05-28 21:56:01,044][Node][DEBUG] Received HELLO from 0
[2024-05-28 21:56:01,044][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,045][Sharing][DEBUG] Model sending this round: [-0.07405949  0.05225723 -0.03091832 ... -0.00437572  0.00584601
 -0.01257165]
[2024-05-28 21:56:01,045][TCP][DEBUG] 7 sent the message to 0.
[2024-05-28 21:56:01,046][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,046][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,051][Node][DEBUG] Received some message from 0 with CHANNEL: DPSGD
[2024-05-28 21:56:01,052][DPSGDNode][DEBUG] Received Model from 0 of iteration 1
[2024-05-28 21:56:01,052][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,052][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,052][Sharing][DEBUG] Averaging model from neighbor 0 of iteration 1
[2024-05-28 21:56:01,071][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,071][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,071][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,071][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,118][Training][DEBUG] Round: 1 loss: 2.146639347076416
[2024-05-28 21:56:01,148][Training][DEBUG] Round: 2 loss: 2.1732914447784424
[2024-05-28 21:56:01,191][Training][DEBUG] Round: 3 loss: 2.262650966644287
[2024-05-28 21:56:01,191][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,213][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:01,214][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,215][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,215][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,216][Sharing][DEBUG] Model sending this round: [-0.07361737  0.05245474 -0.03131147 ... -0.00478072  0.0064186
 -0.01178063]
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,217][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,246][Training][DEBUG] Round: 1 loss: 3.3584117889404297
[2024-05-28 21:56:01,319][Training][DEBUG] Round: 2 loss: 2.926639199256897
[2024-05-28 21:56:01,357][Training][DEBUG] Round: 3 loss: 2.68434206644694
[2024-05-28 21:56:01,357][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,358][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:01,358][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,372][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,372][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {11}
[2024-05-28 21:56:01,372][Node][DEBUG] Sending connection request to 11
[2024-05-28 21:56:01,372][TCP][DEBUG] Connecting to my neighbour: 11
[2024-05-28 21:56:01,373][TCP][DEBUG] 7 sent the message to 11.
[2024-05-28 21:56:01,373][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,374][Node][DEBUG] Waiting HELLO from 11
[2024-05-28 21:56:01,524][Node][DEBUG] Received some message from 0 with CHANNEL: DPSGD
[2024-05-28 21:56:01,534][Node][DEBUG] Received some message from 11 with CHANNEL: CONNECT
[2024-05-28 21:56:01,537][Node][DEBUG] Received HELLO from 11
[2024-05-28 21:56:01,537][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,538][Sharing][DEBUG] Model sending this round: [-0.07300062  0.05318785 -0.03089913 ... -0.00479512  0.00589777
 -0.01212583]
[2024-05-28 21:56:01,542][TCP][DEBUG] 7 sent the message to 11.
[2024-05-28 21:56:01,545][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,545][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,546][DPSGDNode][DEBUG] Received Model from 0 of iteration 6
[2024-05-28 21:56:01,547][Node][DEBUG] Received some message from 11 with CHANNEL: DPSGD
[2024-05-28 21:56:01,547][DPSGDNode][DEBUG] Received Model from 11 of iteration 3
[2024-05-28 21:56:01,547][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,547][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,548][Sharing][DEBUG] Averaging model from neighbor 11 of iteration 3
[2024-05-28 21:56:01,554][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,556][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,556][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,559][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,594][Training][DEBUG] Round: 1 loss: 2.170167922973633
[2024-05-28 21:56:01,615][Training][DEBUG] Round: 2 loss: 2.634485960006714
[2024-05-28 21:56:01,638][Training][DEBUG] Round: 3 loss: 2.453591267267863
[2024-05-28 21:56:01,638][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,638][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:01,639][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,657][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,657][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,657][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,659][Sharing][DEBUG] Model sending this round: [-0.07266854  0.05370767 -0.0300485  ... -0.00244361  0.00674152
 -0.01300835]
[2024-05-28 21:56:01,660][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,662][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,664][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,665][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,665][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,665][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,666][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,700][Training][DEBUG] Round: 1 loss: 2.2368202209472656
[2024-05-28 21:56:01,728][Training][DEBUG] Round: 2 loss: 2.4029934406280518
[2024-05-28 21:56:01,759][Training][DEBUG] Round: 3 loss: 2.3283562660217285
[2024-05-28 21:56:01,760][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,760][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:01,760][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,779][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,779][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,780][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,781][Sharing][DEBUG] Model sending this round: [-0.07260603  0.05381371 -0.02992199 ... -0.00398604  0.00691127
 -0.01397777]
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,782][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,808][Training][DEBUG] Round: 1 loss: 2.0532968044281006
[2024-05-28 21:56:01,837][Training][DEBUG] Round: 2 loss: 2.1986191272735596
[2024-05-28 21:56:01,873][Training][DEBUG] Round: 3 loss: 2.100839614868164
[2024-05-28 21:56:01,874][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,874][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:01,874][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,898][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,898][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {0}
[2024-05-28 21:56:01,898][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,898][Sharing][DEBUG] Model sending this round: [-0.07261198  0.05390425 -0.02994569 ... -0.00605899  0.00764337
 -0.01459033]
[2024-05-28 21:56:01,899][TCP][DEBUG] 7 sent the message to 0.
[2024-05-28 21:56:01,899][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,899][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,899][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,899][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,899][Sharing][DEBUG] Averaging model from neighbor 0 of iteration 6
[2024-05-28 21:56:01,903][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,903][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,903][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,905][DPSGDNode][INFO] Starting training iteration: 7
[2024-05-28 21:56:01,952][Training][DEBUG] Round: 1 loss: 2.2146730422973633
[2024-05-28 21:56:01,991][Training][DEBUG] Round: 2 loss: 2.2612509727478027
[2024-05-28 21:56:02,009][Training][DEBUG] Round: 3 loss: 2.2695000171661377
[2024-05-28 21:56:02,009][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:02,009][TCP][DEBUG] 7 sent the message to -1.
[2024-05-28 21:56:02,009][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:02,010][Node][DEBUG] Received some message from 0 with CHANNEL: DPSGD
