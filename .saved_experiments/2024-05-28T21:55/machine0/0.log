[2024-05-28 21:55:56,459][DPSGDNode][DEBUG] Rank: 0
[2024-05-28 21:55:56,459][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,459][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,426][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:58,468][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:58,503][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:55:59,538][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:55:59,555][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:55:59,672][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:55:59,673][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:55:59,673][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:55:59,675][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:55:59,675][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:55:59,675][Node][DEBUG] Waiting HELLO from -1
[2024-05-28 21:55:59,729][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:55:59,730][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:55:59,732][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:55:59,902][Training][DEBUG] Round: 1 loss: 2.506894111633301
[2024-05-28 21:55:59,920][Training][DEBUG] Round: 2 loss: 2.508418560028076
[2024-05-28 21:55:59,936][Training][DEBUG] Round: 3 loss: 2.519157330195109
[2024-05-28 21:55:59,940][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:55:59,942][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:55:59,943][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,861][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,861][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:00,861][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:00,862][Sharing][DEBUG] Model sending this round: [-0.07372975  0.05238217 -0.03166332 ... -0.00380573  0.00648273
 -0.0103545 ]
[2024-05-28 21:56:00,862][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:00,862][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:00,863][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:00,864][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:00,864][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:00,864][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:00,864][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:00,903][Training][DEBUG] Round: 1 loss: 2.238173007965088
[2024-05-28 21:56:00,946][Training][DEBUG] Round: 2 loss: 2.89389967918396
[2024-05-28 21:56:00,979][Training][DEBUG] Round: 3 loss: 2.8593668937683105
[2024-05-28 21:56:00,979][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,980][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:00,980][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,992][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,992][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {7}
[2024-05-28 21:56:00,994][Node][DEBUG] Sending connection request to 7
[2024-05-28 21:56:00,994][TCP][DEBUG] Connecting to my neighbour: 7
[2024-05-28 21:56:00,996][TCP][DEBUG] 0 sent the message to 7.
[2024-05-28 21:56:00,996][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,996][Node][DEBUG] Waiting HELLO from 7
[2024-05-28 21:56:01,046][Node][DEBUG] Received some message from 7 with CHANNEL: CONNECT
[2024-05-28 21:56:01,046][Node][DEBUG] Received HELLO from 7
[2024-05-28 21:56:01,046][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,047][Sharing][DEBUG] Model sending this round: [-0.07349595  0.05281258 -0.03116227 ... -0.00537309  0.00928874
 -0.01275686]
[2024-05-28 21:56:01,048][TCP][DEBUG] 0 sent the message to 7.
[2024-05-28 21:56:01,048][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,048][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,048][Node][DEBUG] Received some message from 7 with CHANNEL: DPSGD
[2024-05-28 21:56:01,049][DPSGDNode][DEBUG] Received Model from 7 of iteration 1
[2024-05-28 21:56:01,049][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,049][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,049][Sharing][DEBUG] Averaging model from neighbor 7 of iteration 1
[2024-05-28 21:56:01,050][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,050][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,050][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,051][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,077][Training][DEBUG] Round: 1 loss: 2.496716022491455
[2024-05-28 21:56:01,102][Training][DEBUG] Round: 2 loss: 2.915711760520935
[2024-05-28 21:56:01,127][Training][DEBUG] Round: 3 loss: 2.9168675740559897
[2024-05-28 21:56:01,127][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,127][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:01,127][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,139][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,139][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,139][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,139][Sharing][DEBUG] Model sending this round: [-0.07353291  0.05282045 -0.03086542 ... -0.00417542  0.00510199
 -0.01242732]
[2024-05-28 21:56:01,139][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,139][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,139][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,140][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,140][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,140][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,140][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,172][Training][DEBUG] Round: 1 loss: 2.110854148864746
[2024-05-28 21:56:01,197][Training][DEBUG] Round: 2 loss: 2.1346890926361084
[2024-05-28 21:56:01,219][Training][DEBUG] Round: 3 loss: 2.447991132736206
[2024-05-28 21:56:01,219][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,219][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:01,220][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,230][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,230][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,230][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,231][Sharing][DEBUG] Model sending this round: [-0.07346793  0.05276458 -0.03088286 ... -0.00416798  0.0083936
 -0.01230326]
[2024-05-28 21:56:01,231][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,231][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,231][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,231][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,231][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,231][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,231][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,255][Training][DEBUG] Round: 1 loss: 2.5279059410095215
[2024-05-28 21:56:01,275][Training][DEBUG] Round: 2 loss: 2.490732192993164
[2024-05-28 21:56:01,301][Training][DEBUG] Round: 3 loss: 2.48150102297465
[2024-05-28 21:56:01,301][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,302][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:01,302][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,311][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,311][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,311][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,312][Sharing][DEBUG] Model sending this round: [-0.07367067  0.05268535 -0.03105368 ... -0.0042724   0.00634776
 -0.01290902]
[2024-05-28 21:56:01,313][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,313][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,313][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,313][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,313][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,314][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,315][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,347][Training][DEBUG] Round: 1 loss: 2.310161590576172
[2024-05-28 21:56:01,375][Training][DEBUG] Round: 2 loss: 2.375298023223877
[2024-05-28 21:56:01,401][Training][DEBUG] Round: 3 loss: 2.2921934127807617
[2024-05-28 21:56:01,401][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,402][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:01,402][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,411][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,411][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,412][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,412][Sharing][DEBUG] Model sending this round: [-0.07391591  0.05245676 -0.03136523 ... -0.00462477  0.00712584
 -0.0133898 ]
[2024-05-28 21:56:01,412][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,412][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,412][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,413][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,413][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,413][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,413][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,435][Training][DEBUG] Round: 1 loss: 2.075701951980591
[2024-05-28 21:56:01,455][Training][DEBUG] Round: 2 loss: 2.464201331138611
[2024-05-28 21:56:01,486][Training][DEBUG] Round: 3 loss: 2.380673885345459
[2024-05-28 21:56:01,486][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,487][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:01,487][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,517][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,517][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {7}
[2024-05-28 21:56:01,522][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,522][Sharing][DEBUG] Model sending this round: [-0.07383383  0.05258129 -0.03115456 ... -0.00511018  0.00714037
 -0.01197731]
[2024-05-28 21:56:01,523][TCP][DEBUG] 0 sent the message to 7.
[2024-05-28 21:56:01,523][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,523][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,903][Node][DEBUG] Received some message from 7 with CHANNEL: DPSGD
[2024-05-28 21:56:01,903][DPSGDNode][DEBUG] Received Model from 7 of iteration 6
[2024-05-28 21:56:01,903][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,904][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,904][Sharing][DEBUG] Averaging model from neighbor 7 of iteration 6
[2024-05-28 21:56:01,904][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,904][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,905][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,905][DPSGDNode][INFO] Starting training iteration: 7
[2024-05-28 21:56:01,938][Training][DEBUG] Round: 1 loss: 2.146378755569458
[2024-05-28 21:56:01,963][Training][DEBUG] Round: 2 loss: 2.49405837059021
[2024-05-28 21:56:01,990][Training][DEBUG] Round: 3 loss: 2.5083374977111816
[2024-05-28 21:56:01,990][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,990][TCP][DEBUG] 0 sent the message to -1.
[2024-05-28 21:56:01,990][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,995][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,995][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {7}
[2024-05-28 21:56:01,995][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,995][Sharing][DEBUG] Model sending this round: [-0.07351579  0.05288593 -0.03100392 ... -0.00702874  0.00622085
 -0.01148488]
[2024-05-28 21:56:01,996][TCP][DEBUG] 0 sent the message to 7.
[2024-05-28 21:56:01,996][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,996][DPSGDNode][DEBUG] Sent to all neighbors
