[2024-05-28 21:55:56,429][DPSGDNode][DEBUG] Rank: 11
[2024-05-28 21:55:56,429][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,429][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,562][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,827][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,844][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,695][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,697][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,753][Node][DEBUG] Sending connection request to 1
[2024-05-28 21:56:00,753][TCP][DEBUG] Connecting to my neighbour: 1
[2024-05-28 21:56:00,754][TCP][DEBUG] 11 sent the message to 1.
[2024-05-28 21:56:00,754][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,754][Node][DEBUG] Waiting HELLO from 1
[2024-05-28 21:56:00,794][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,794][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,794][Node][DEBUG] Waiting HELLO from 1
[2024-05-28 21:56:00,855][Node][DEBUG] Received some message from 1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,855][Node][DEBUG] Received HELLO from 1
[2024-05-28 21:56:00,855][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,855][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,855][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,856][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:00,856][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,856][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:01,007][Training][DEBUG] Round: 1 loss: 2.169243097305298
[2024-05-28 21:56:01,043][Training][DEBUG] Round: 2 loss: 2.1952661275863647
[2024-05-28 21:56:01,081][Training][DEBUG] Round: 3 loss: 2.6412180264790854
[2024-05-28 21:56:01,081][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,084][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,085][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,086][Node][DEBUG] Received some message from 1 with CHANNEL: DPSGD
[2024-05-28 21:56:01,115][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,115][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {1}
[2024-05-28 21:56:01,118][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,124][Sharing][DEBUG] Model sending this round: [-0.07396898  0.05273782 -0.03041399 ... -0.00564826  0.00585693
 -0.01085395]
[2024-05-28 21:56:01,126][TCP][DEBUG] 11 sent the message to 1.
[2024-05-28 21:56:01,126][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,126][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,126][DPSGDNode][DEBUG] Received Model from 1 of iteration 0
[2024-05-28 21:56:01,126][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,127][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,127][Sharing][DEBUG] Averaging model from neighbor 1 of iteration 0
[2024-05-28 21:56:01,131][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,131][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,131][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,132][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:01,172][Training][DEBUG] Round: 1 loss: 2.9272725582122803
[2024-05-28 21:56:01,210][Training][DEBUG] Round: 2 loss: 3.142708897590637
[2024-05-28 21:56:01,234][Training][DEBUG] Round: 3 loss: 3.121403694152832
[2024-05-28 21:56:01,235][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,237][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,237][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,249][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,249][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,249][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,268][Sharing][DEBUG] Model sending this round: [-0.07291731  0.05339097 -0.03003879 ... -0.00556205  0.00582847
 -0.01229572]
[2024-05-28 21:56:01,268][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,268][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,268][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,269][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,269][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,269][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,269][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,296][Training][DEBUG] Round: 1 loss: 2.2188735008239746
[2024-05-28 21:56:01,351][Training][DEBUG] Round: 2 loss: 2.6497167348861694
[2024-05-28 21:56:01,393][Training][DEBUG] Round: 3 loss: 2.634066899617513
[2024-05-28 21:56:01,394][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,395][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,395][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,396][Node][DEBUG] Received some message from 7 with CHANNEL: CONNECT
[2024-05-28 21:56:01,406][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,406][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,407][Sharing][DEBUG] Model sending this round: [-0.07264148  0.05360815 -0.03001939 ... -0.004304    0.00875815
 -0.01252376]
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,407][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,408][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,429][Training][DEBUG] Round: 1 loss: 2.6645243167877197
[2024-05-28 21:56:01,447][Training][DEBUG] Round: 2 loss: 2.397285580635071
[2024-05-28 21:56:01,477][Training][DEBUG] Round: 3 loss: 2.5245606899261475
[2024-05-28 21:56:01,477][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,478][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,478][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,524][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,524][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {7}
[2024-05-28 21:56:01,527][Node][DEBUG] Sending connection request to 7
[2024-05-28 21:56:01,527][TCP][DEBUG] Connecting to my neighbour: 7
[2024-05-28 21:56:01,529][TCP][DEBUG] 11 sent the message to 7.
[2024-05-28 21:56:01,529][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,530][Node][DEBUG] Waiting HELLO from 7
[2024-05-28 21:56:01,530][Node][DEBUG] Received HELLO from 7
[2024-05-28 21:56:01,530][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,531][Sharing][DEBUG] Model sending this round: [-0.07230881  0.05400776 -0.02945615 ... -0.00648523  0.00738906
 -0.01158273]
[2024-05-28 21:56:01,532][TCP][DEBUG] 11 sent the message to 7.
[2024-05-28 21:56:01,532][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,532][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,548][Node][DEBUG] Received some message from 7 with CHANNEL: DPSGD
[2024-05-28 21:56:01,549][DPSGDNode][DEBUG] Received Model from 7 of iteration 3
[2024-05-28 21:56:01,549][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,549][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,551][Sharing][DEBUG] Averaging model from neighbor 7 of iteration 3
[2024-05-28 21:56:01,555][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,556][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,556][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,557][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,588][Training][DEBUG] Round: 1 loss: 2.3952579498291016
[2024-05-28 21:56:01,612][Training][DEBUG] Round: 2 loss: 2.109785318374634
[2024-05-28 21:56:01,644][Training][DEBUG] Round: 3 loss: 2.382776419321696
[2024-05-28 21:56:01,645][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,645][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,645][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,682][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,683][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,689][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,690][Sharing][DEBUG] Model sending this round: [-0.07214747  0.05397582 -0.03017049 ... -0.00202526  0.0076205
 -0.01181532]
[2024-05-28 21:56:01,690][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,691][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,692][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,692][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,693][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,694][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,695][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,733][Training][DEBUG] Round: 1 loss: 2.5791304111480713
[2024-05-28 21:56:01,757][Training][DEBUG] Round: 2 loss: 2.580912232398987
[2024-05-28 21:56:01,780][Training][DEBUG] Round: 3 loss: 2.5558807055155435
[2024-05-28 21:56:01,780][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,780][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,780][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,788][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,788][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,788][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,789][Sharing][DEBUG] Model sending this round: [-0.07222722  0.05371891 -0.03041366 ... -0.00589584  0.00732853
 -0.01224144]
[2024-05-28 21:56:01,790][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,790][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,790][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,790][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,790][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,790][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,791][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,820][Training][DEBUG] Round: 1 loss: 2.077061176300049
[2024-05-28 21:56:01,844][Training][DEBUG] Round: 2 loss: 2.22143816947937
[2024-05-28 21:56:01,870][Training][DEBUG] Round: 3 loss: 2.280231157938639
[2024-05-28 21:56:01,871][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,871][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,871][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,886][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,886][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,886][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,887][Sharing][DEBUG] Model sending this round: [-0.07213265  0.05392112 -0.03030855 ... -0.00565777  0.00959111
 -0.01163153]
[2024-05-28 21:56:01,887][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,887][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,887][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,887][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,887][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,887][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,888][DPSGDNode][INFO] Starting training iteration: 7
[2024-05-28 21:56:01,925][Training][DEBUG] Round: 1 loss: 2.3714113235473633
[2024-05-28 21:56:01,960][Training][DEBUG] Round: 2 loss: 2.124093174934387
[2024-05-28 21:56:01,991][Training][DEBUG] Round: 3 loss: 2.097684065500895
[2024-05-28 21:56:01,991][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,991][TCP][DEBUG] 11 sent the message to -1.
[2024-05-28 21:56:01,991][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,993][Node][DEBUG] Received some message from 6 with CHANNEL: CONNECT
[2024-05-28 21:56:01,999][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,999][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {6}
[2024-05-28 21:56:02,004][Node][DEBUG] Sending connection request to 6
[2024-05-28 21:56:02,004][TCP][DEBUG] Connecting to my neighbour: 6
[2024-05-28 21:56:02,006][TCP][DEBUG] 11 sent the message to 6.
[2024-05-28 21:56:02,007][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:02,011][Node][DEBUG] Waiting HELLO from 6
[2024-05-28 21:56:02,011][Node][DEBUG] Received HELLO from 6
[2024-05-28 21:56:02,011][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:02,011][Sharing][DEBUG] Model sending this round: [-0.07191432  0.05400455 -0.03027408 ... -0.00382058  0.00731103
 -0.01158297]
[2024-05-28 21:56:02,012][TCP][DEBUG] 11 sent the message to 6.
[2024-05-28 21:56:02,012][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:02,012][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:02,013][Node][DEBUG] Received some message from 6 with CHANNEL: DPSGD
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Received Model from 6 of iteration 7
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:02,014][Sharing][DEBUG] Averaging model from neighbor 6 of iteration 7
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:02,014][DPSGDNode][INFO] Starting training iteration: 8
