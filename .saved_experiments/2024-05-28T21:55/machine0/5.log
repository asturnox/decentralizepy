[2024-05-28 21:55:56,317][DPSGDNode][DEBUG] Rank: 5
[2024-05-28 21:55:56,317][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,317][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,401][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,617][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,655][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,530][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,531][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,564][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,564][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,564][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,564][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:00,564][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,565][Node][DEBUG] Waiting HELLO from -1
[2024-05-28 21:56:00,643][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,643][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,644][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:00,691][Training][DEBUG] Round: 1 loss: 2.3504538536071777
[2024-05-28 21:56:00,708][Training][DEBUG] Round: 2 loss: 2.6913121938705444
[2024-05-28 21:56:00,725][Training][DEBUG] Round: 3 loss: 2.928590695063273
[2024-05-28 21:56:00,725][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,725][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:00,725][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,877][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,877][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:00,878][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:00,885][Sharing][DEBUG] Model sending this round: [-0.07359439  0.05186281 -0.03207887 ... -0.00449419  0.0080326
 -0.01123158]
[2024-05-28 21:56:00,886][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:00,886][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:00,887][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:00,888][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:00,888][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:00,888][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:00,889][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:00,951][Training][DEBUG] Round: 1 loss: 1.9711058139801025
[2024-05-28 21:56:00,985][Training][DEBUG] Round: 2 loss: 2.609318494796753
[2024-05-28 21:56:01,022][Training][DEBUG] Round: 3 loss: 2.9505066871643066
[2024-05-28 21:56:01,023][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,023][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:01,023][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,048][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,048][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,051][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,053][Sharing][DEBUG] Model sending this round: [-0.07413841  0.05108644 -0.03276033 ... -0.00391198  0.00901456
 -0.01484261]
[2024-05-28 21:56:01,053][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,054][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,054][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,054][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,054][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,054][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,055][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,094][Training][DEBUG] Round: 1 loss: 2.704163074493408
[2024-05-28 21:56:01,137][Training][DEBUG] Round: 2 loss: 2.6695035696029663
[2024-05-28 21:56:01,179][Training][DEBUG] Round: 3 loss: 2.8068675994873047
[2024-05-28 21:56:01,180][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,186][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:01,187][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,201][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,202][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,202][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,203][Sharing][DEBUG] Model sending this round: [-0.07371847  0.05142384 -0.03244566 ... -0.00364736  0.00765678
 -0.01275284]
[2024-05-28 21:56:01,203][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,203][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,203][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,203][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,203][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,204][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,204][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,233][Training][DEBUG] Round: 1 loss: 2.087141990661621
[2024-05-28 21:56:01,265][Training][DEBUG] Round: 2 loss: 2.449437737464905
[2024-05-28 21:56:01,285][Training][DEBUG] Round: 3 loss: 2.4469757080078125
[2024-05-28 21:56:01,286][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,286][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:01,286][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,302][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,303][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,303][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,303][Sharing][DEBUG] Model sending this round: [-0.07364286  0.05155858 -0.0321495  ... -0.00611523  0.00768051
 -0.01261884]
[2024-05-28 21:56:01,303][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,304][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,307][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,341][Training][DEBUG] Round: 1 loss: 1.7272238731384277
[2024-05-28 21:56:01,378][Training][DEBUG] Round: 2 loss: 2.131507396697998
[2024-05-28 21:56:01,406][Training][DEBUG] Round: 3 loss: 2.3710505167643228
[2024-05-28 21:56:01,406][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,406][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:01,406][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,518][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,519][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,531][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,532][Sharing][DEBUG] Model sending this round: [-0.07360463  0.0517395  -0.03190282 ... -0.00470257  0.00623795
 -0.01227652]
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,534][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,575][Training][DEBUG] Round: 1 loss: 2.1772453784942627
[2024-05-28 21:56:01,606][Training][DEBUG] Round: 2 loss: 2.215737819671631
[2024-05-28 21:56:01,631][Training][DEBUG] Round: 3 loss: 2.347425619761149
[2024-05-28 21:56:01,631][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,632][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:01,632][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,644][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,644][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,644][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,645][Sharing][DEBUG] Model sending this round: [-0.07363261  0.05168074 -0.03217386 ... -0.00587774  0.00620723
 -0.01079402]
[2024-05-28 21:56:01,645][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,645][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,645][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,645][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,645][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,645][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,645][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,679][Training][DEBUG] Round: 1 loss: 2.0114479064941406
[2024-05-28 21:56:01,712][Training][DEBUG] Round: 2 loss: 1.9914918541908264
[2024-05-28 21:56:01,744][Training][DEBUG] Round: 3 loss: 2.1824409564336142
[2024-05-28 21:56:01,744][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,746][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:01,746][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,762][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,762][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {9, 2}
[2024-05-28 21:56:01,762][Node][DEBUG] Sending connection request to 9
[2024-05-28 21:56:01,762][TCP][DEBUG] Connecting to my neighbour: 9
[2024-05-28 21:56:01,762][TCP][DEBUG] 5 sent the message to 9.
[2024-05-28 21:56:01,763][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,763][Node][DEBUG] Sending connection request to 2
[2024-05-28 21:56:01,763][TCP][DEBUG] Connecting to my neighbour: 2
[2024-05-28 21:56:01,763][TCP][DEBUG] 5 sent the message to 2.
[2024-05-28 21:56:01,763][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,766][Node][DEBUG] Waiting HELLO from 9
[2024-05-28 21:56:01,873][Node][DEBUG] Received some message from 9 with CHANNEL: CONNECT
[2024-05-28 21:56:01,873][Node][DEBUG] Received HELLO from 9
[2024-05-28 21:56:01,874][Node][DEBUG] Waiting HELLO from 2
[2024-05-28 21:56:01,876][Node][DEBUG] Received some message from 9 with CHANNEL: DPSGD
[2024-05-28 21:56:01,878][Node][DEBUG] Received some message from 2 with CHANNEL: CONNECT
[2024-05-28 21:56:01,880][Node][DEBUG] Received HELLO from 2
[2024-05-28 21:56:01,880][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,881][Sharing][DEBUG] Model sending this round: [-0.07367604  0.05167847 -0.0320488  ... -0.00722652  0.00732824
 -0.00974762]
[2024-05-28 21:56:01,881][TCP][DEBUG] 5 sent the message to 9.
[2024-05-28 21:56:01,882][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,882][TCP][DEBUG] 5 sent the message to 2.
[2024-05-28 21:56:01,882][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,882][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,882][DPSGDNode][DEBUG] Received Model from 9 of iteration 6
[2024-05-28 21:56:01,882][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,883][DPSGDNode][DEBUG] Received Model from 2 of iteration 6
[2024-05-28 21:56:01,883][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,883][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,883][Sharing][DEBUG] Averaging model from neighbor 9 of iteration 6
[2024-05-28 21:56:01,883][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 6
[2024-05-28 21:56:01,884][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,884][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,884][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,884][DPSGDNode][INFO] Starting training iteration: 7
[2024-05-28 21:56:01,921][Training][DEBUG] Round: 1 loss: 2.178828001022339
[2024-05-28 21:56:01,966][Training][DEBUG] Round: 2 loss: 2.4611846208572388
[2024-05-28 21:56:01,999][Training][DEBUG] Round: 3 loss: 2.4202917416890464
[2024-05-28 21:56:02,000][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:02,000][TCP][DEBUG] 5 sent the message to -1.
[2024-05-28 21:56:02,000][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:02,001][Node][DEBUG] Received some message from 9 with CHANNEL: DPSGD
[2024-05-28 21:56:02,016][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:02,016][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {9}
[2024-05-28 21:56:02,016][DPSGDNode][DEBUG] Connected to all neighbors
