[2024-05-28 21:55:56,332][DPSGDNode][DEBUG] Rank: 6
[2024-05-28 21:55:56,332][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,332][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,463][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,823][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,849][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,683][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,684][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,729][Node][DEBUG] Sending connection request to 4
[2024-05-28 21:56:00,729][TCP][DEBUG] Connecting to my neighbour: 4
[2024-05-28 21:56:00,730][TCP][DEBUG] 6 sent the message to 4.
[2024-05-28 21:56:00,730][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,730][Node][DEBUG] Waiting HELLO from 4
[2024-05-28 21:56:00,730][Node][DEBUG] Received some message from 4 with CHANNEL: CONNECT
[2024-05-28 21:56:00,730][Node][DEBUG] Received HELLO from 4
[2024-05-28 21:56:00,730][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,730][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,730][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,730][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:00,730][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,731][Node][DEBUG] Waiting HELLO from -1
[2024-05-28 21:56:00,814][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,814][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,815][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:00,891][Training][DEBUG] Round: 1 loss: 2.4422364234924316
[2024-05-28 21:56:00,949][Training][DEBUG] Round: 2 loss: 2.471518874168396
[2024-05-28 21:56:00,981][Training][DEBUG] Round: 3 loss: 2.5126543045043945
[2024-05-28 21:56:00,981][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,982][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:00,982][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,984][Node][DEBUG] Received some message from 4 with CHANNEL: DPSGD
[2024-05-28 21:56:01,010][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,010][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {4}
[2024-05-28 21:56:01,013][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,018][Sharing][DEBUG] Model sending this round: [-0.07218059  0.05381678 -0.02976063 ... -0.00326244  0.00602441
 -0.01208402]
[2024-05-28 21:56:01,020][TCP][DEBUG] 6 sent the message to 4.
[2024-05-28 21:56:01,020][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,020][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,020][DPSGDNode][DEBUG] Received Model from 4 of iteration 0
[2024-05-28 21:56:01,020][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,020][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,020][Sharing][DEBUG] Averaging model from neighbor 4 of iteration 0
[2024-05-28 21:56:01,023][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,023][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,023][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,027][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:01,054][Training][DEBUG] Round: 1 loss: 2.4566588401794434
[2024-05-28 21:56:01,098][Training][DEBUG] Round: 2 loss: 2.540273427963257
[2024-05-28 21:56:01,137][Training][DEBUG] Round: 3 loss: 2.6107164223988852
[2024-05-28 21:56:01,138][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,138][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,138][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,140][Node][DEBUG] Received some message from 10 with CHANNEL: CONNECT
[2024-05-28 21:56:01,142][Node][DEBUG] Received some message from 2 with CHANNEL: CONNECT
[2024-05-28 21:56:01,148][Node][DEBUG] Received some message from 9 with CHANNEL: CONNECT
[2024-05-28 21:56:01,166][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,166][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,166][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,190][Sharing][DEBUG] Model sending this round: [-0.07358679  0.05244139 -0.03106397 ... -0.00666769  0.00675804
 -0.01205266]
[2024-05-28 21:56:01,190][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,190][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,190][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,191][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,191][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,191][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,192][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,218][Training][DEBUG] Round: 1 loss: 2.381972312927246
[2024-05-28 21:56:01,237][Training][DEBUG] Round: 2 loss: 2.2537485361099243
[2024-05-28 21:56:01,267][Training][DEBUG] Round: 3 loss: 2.6463220914204917
[2024-05-28 21:56:01,268][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,268][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,268][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,277][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,278][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {9, 2, 10}
[2024-05-28 21:56:01,278][Node][DEBUG] Sending connection request to 9
[2024-05-28 21:56:01,278][TCP][DEBUG] Connecting to my neighbour: 9
[2024-05-28 21:56:01,287][TCP][DEBUG] 6 sent the message to 9.
[2024-05-28 21:56:01,287][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,287][Node][DEBUG] Sending connection request to 2
[2024-05-28 21:56:01,287][TCP][DEBUG] Connecting to my neighbour: 2
[2024-05-28 21:56:01,288][TCP][DEBUG] 6 sent the message to 2.
[2024-05-28 21:56:01,288][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,288][Node][DEBUG] Sending connection request to 10
[2024-05-28 21:56:01,288][TCP][DEBUG] Connecting to my neighbour: 10
[2024-05-28 21:56:01,291][TCP][DEBUG] 6 sent the message to 10.
[2024-05-28 21:56:01,291][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,292][Node][DEBUG] Waiting HELLO from 9
[2024-05-28 21:56:01,292][Node][DEBUG] Received HELLO from 10
[2024-05-28 21:56:01,292][Node][DEBUG] Waiting HELLO from 9
[2024-05-28 21:56:01,293][Node][DEBUG] Received HELLO from 2
[2024-05-28 21:56:01,293][Node][DEBUG] Waiting HELLO from 9
[2024-05-28 21:56:01,293][Node][DEBUG] Received HELLO from 9
[2024-05-28 21:56:01,298][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,299][Sharing][DEBUG] Model sending this round: [-0.07335223  0.05260826 -0.03118851 ... -0.0071793   0.00393917
 -0.0132385 ]
[2024-05-28 21:56:01,299][TCP][DEBUG] 6 sent the message to 9.
[2024-05-28 21:56:01,300][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,301][TCP][DEBUG] 6 sent the message to 2.
[2024-05-28 21:56:01,301][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,301][TCP][DEBUG] 6 sent the message to 10.
[2024-05-28 21:56:01,301][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,302][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,302][Node][DEBUG] Received some message from 9 with CHANNEL: DPSGD
[2024-05-28 21:56:01,302][DPSGDNode][DEBUG] Received Model from 9 of iteration 2
[2024-05-28 21:56:01,303][Node][DEBUG] Received some message from 10 with CHANNEL: DPSGD
[2024-05-28 21:56:01,303][DPSGDNode][DEBUG] Received Model from 10 of iteration 2
[2024-05-28 21:56:01,303][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,303][DPSGDNode][DEBUG] Received Model from 2 of iteration 2
[2024-05-28 21:56:01,304][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,304][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,304][Sharing][DEBUG] Averaging model from neighbor 9 of iteration 2
[2024-05-28 21:56:01,304][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 2
[2024-05-28 21:56:01,304][Sharing][DEBUG] Averaging model from neighbor 10 of iteration 2
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,305][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,305][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,343][Training][DEBUG] Round: 1 loss: 2.78764271736145
[2024-05-28 21:56:01,379][Training][DEBUG] Round: 2 loss: 2.6835644245147705
[2024-05-28 21:56:01,405][Training][DEBUG] Round: 3 loss: 2.5763309796651206
[2024-05-28 21:56:01,405][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,405][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,405][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,406][Node][DEBUG] Received some message from 9 with CHANNEL: DPSGD
[2024-05-28 21:56:01,407][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,499][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,499][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {9, 2}
[2024-05-28 21:56:01,503][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,504][Sharing][DEBUG] Model sending this round: [-0.07347108  0.05277903 -0.03078797 ... -0.0060702   0.00719109
 -0.00970002]
[2024-05-28 21:56:01,504][TCP][DEBUG] 6 sent the message to 9.
[2024-05-28 21:56:01,504][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,505][TCP][DEBUG] 6 sent the message to 2.
[2024-05-28 21:56:01,505][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,505][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,505][DPSGDNode][DEBUG] Received Model from 9 of iteration 3
[2024-05-28 21:56:01,505][DPSGDNode][DEBUG] Received Model from 2 of iteration 3
[2024-05-28 21:56:01,505][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,505][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,505][Sharing][DEBUG] Averaging model from neighbor 9 of iteration 3
[2024-05-28 21:56:01,505][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 3
[2024-05-28 21:56:01,508][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,508][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,508][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,508][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,527][Training][DEBUG] Round: 1 loss: 1.9894627332687378
[2024-05-28 21:56:01,585][Training][DEBUG] Round: 2 loss: 2.14283686876297
[2024-05-28 21:56:01,610][Training][DEBUG] Round: 3 loss: 2.2656461795171103
[2024-05-28 21:56:01,610][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,610][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,610][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,631][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,631][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {2}
[2024-05-28 21:56:01,638][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,639][Sharing][DEBUG] Model sending this round: [-0.07277193  0.053026   -0.0308008  ... -0.00653147  0.00909001
 -0.01296916]
[2024-05-28 21:56:01,639][TCP][DEBUG] 6 sent the message to 2.
[2024-05-28 21:56:01,639][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,639][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,660][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,660][DPSGDNode][DEBUG] Received Model from 2 of iteration 4
[2024-05-28 21:56:01,661][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,661][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,662][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 4
[2024-05-28 21:56:01,664][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,664][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,665][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,667][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,720][Training][DEBUG] Round: 1 loss: 2.3277902603149414
[2024-05-28 21:56:01,747][Training][DEBUG] Round: 2 loss: 2.4718483686447144
[2024-05-28 21:56:01,771][Training][DEBUG] Round: 3 loss: 2.4104057153066
[2024-05-28 21:56:01,772][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,772][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,772][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,773][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,784][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,784][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {9, 2}
[2024-05-28 21:56:01,786][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,787][Sharing][DEBUG] Model sending this round: [-0.07272687  0.05315576 -0.03094069 ... -0.00659861  0.00834237
 -0.01218876]
[2024-05-28 21:56:01,788][TCP][DEBUG] 6 sent the message to 9.
[2024-05-28 21:56:01,788][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,788][TCP][DEBUG] 6 sent the message to 2.
[2024-05-28 21:56:01,788][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,789][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,789][DPSGDNode][DEBUG] Received Model from 2 of iteration 5
[2024-05-28 21:56:01,789][Node][DEBUG] Received some message from 9 with CHANNEL: DPSGD
[2024-05-28 21:56:01,789][DPSGDNode][DEBUG] Received Model from 9 of iteration 5
[2024-05-28 21:56:01,789][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,789][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,789][Sharing][DEBUG] Averaging model from neighbor 9 of iteration 5
[2024-05-28 21:56:01,790][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 5
[2024-05-28 21:56:01,792][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,792][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,792][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,793][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,820][Training][DEBUG] Round: 1 loss: 2.2358644008636475
[2024-05-28 21:56:01,846][Training][DEBUG] Round: 2 loss: 2.41291081905365
[2024-05-28 21:56:01,869][Training][DEBUG] Round: 3 loss: 2.332115093866984
[2024-05-28 21:56:01,870][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,870][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,871][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,881][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,881][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,882][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,883][Sharing][DEBUG] Model sending this round: [-0.07293111  0.05347913 -0.03055608 ... -0.00541558  0.00888497
 -0.01323239]
[2024-05-28 21:56:01,883][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,883][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,883][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,884][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,884][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,884][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,884][DPSGDNode][INFO] Starting training iteration: 7
[2024-05-28 21:56:01,921][Training][DEBUG] Round: 1 loss: 2.3580710887908936
[2024-05-28 21:56:01,948][Training][DEBUG] Round: 2 loss: 2.3410338163375854
[2024-05-28 21:56:01,982][Training][DEBUG] Round: 3 loss: 2.281738599141439
[2024-05-28 21:56:01,982][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,983][TCP][DEBUG] 6 sent the message to -1.
[2024-05-28 21:56:01,983][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,990][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,990][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {11}
[2024-05-28 21:56:01,990][Node][DEBUG] Sending connection request to 11
[2024-05-28 21:56:01,991][TCP][DEBUG] Connecting to my neighbour: 11
[2024-05-28 21:56:01,992][TCP][DEBUG] 6 sent the message to 11.
[2024-05-28 21:56:01,992][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,992][Node][DEBUG] Waiting HELLO from 11
[2024-05-28 21:56:02,008][Node][DEBUG] Received some message from 11 with CHANNEL: CONNECT
[2024-05-28 21:56:02,008][Node][DEBUG] Received HELLO from 11
[2024-05-28 21:56:02,009][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:02,010][Sharing][DEBUG] Model sending this round: [-0.07284028  0.05350839 -0.03029839 ... -0.00643339  0.00784073
 -0.01353924]
[2024-05-28 21:56:02,010][TCP][DEBUG] 6 sent the message to 11.
[2024-05-28 21:56:02,010][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:02,010][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:02,014][Node][DEBUG] Received some message from 11 with CHANNEL: DPSGD
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Received Model from 11 of iteration 7
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:02,014][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:02,014][Sharing][DEBUG] Averaging model from neighbor 11 of iteration 7
[2024-05-28 21:56:02,015][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:02,015][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:02,015][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:02,015][DPSGDNode][INFO] Starting training iteration: 8
