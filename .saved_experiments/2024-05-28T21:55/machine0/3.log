[2024-05-28 21:55:56,209][DPSGDNode][DEBUG] Rank: 3
[2024-05-28 21:55:56,210][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,210][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,416][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,630][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,664][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,546][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,547][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,579][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,580][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,580][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,580][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:00,581][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,581][Node][DEBUG] Waiting HELLO from -1
[2024-05-28 21:56:00,588][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,588][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,588][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:00,636][Training][DEBUG] Round: 1 loss: 2.280458927154541
[2024-05-28 21:56:00,657][Training][DEBUG] Round: 2 loss: 2.7784204483032227
[2024-05-28 21:56:00,675][Training][DEBUG] Round: 3 loss: 3.0645159085591636
[2024-05-28 21:56:00,675][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,675][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:00,675][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,872][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,872][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:00,872][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:00,884][Sharing][DEBUG] Model sending this round: [-0.07323342  0.05314969 -0.03029853 ... -0.00692555  0.00394471
 -0.0105946 ]
[2024-05-28 21:56:00,884][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:00,884][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:00,884][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:00,885][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:00,885][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:00,885][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:00,886][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:00,947][Training][DEBUG] Round: 1 loss: 2.9708690643310547
[2024-05-28 21:56:00,991][Training][DEBUG] Round: 2 loss: 2.979690670967102
[2024-05-28 21:56:01,026][Training][DEBUG] Round: 3 loss: 3.2187629540761313
[2024-05-28 21:56:01,027][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,027][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,027][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,075][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,075][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,075][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,078][Sharing][DEBUG] Model sending this round: [-0.07278682  0.05335503 -0.02994248 ... -0.00480479  0.00876004
 -0.01241181]
[2024-05-28 21:56:01,078][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,078][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,079][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,080][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,080][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,080][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,084][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,155][Training][DEBUG] Round: 1 loss: 2.4384701251983643
[2024-05-28 21:56:01,184][Training][DEBUG] Round: 2 loss: 2.3188105821609497
[2024-05-28 21:56:01,209][Training][DEBUG] Round: 3 loss: 2.2809555530548096
[2024-05-28 21:56:01,210][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,212][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,212][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,215][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,216][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,216][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,216][Sharing][DEBUG] Model sending this round: [-0.07259943  0.05334669 -0.03022889 ... -0.00627205  0.00846565
 -0.01179921]
[2024-05-28 21:56:01,217][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,217][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,217][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,217][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,217][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,217][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,217][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,256][Training][DEBUG] Round: 1 loss: 3.183441400527954
[2024-05-28 21:56:01,277][Training][DEBUG] Round: 2 loss: 2.7470598220825195
[2024-05-28 21:56:01,307][Training][DEBUG] Round: 3 loss: 2.652803818384806
[2024-05-28 21:56:01,307][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,308][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,308][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,322][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,322][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {1, 10}
[2024-05-28 21:56:01,322][Node][DEBUG] Sending connection request to 1
[2024-05-28 21:56:01,322][TCP][DEBUG] Connecting to my neighbour: 1
[2024-05-28 21:56:01,323][TCP][DEBUG] 3 sent the message to 1.
[2024-05-28 21:56:01,323][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,323][Node][DEBUG] Sending connection request to 10
[2024-05-28 21:56:01,323][TCP][DEBUG] Connecting to my neighbour: 10
[2024-05-28 21:56:01,325][TCP][DEBUG] 3 sent the message to 10.
[2024-05-28 21:56:01,325][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,327][Node][DEBUG] Waiting HELLO from 1
[2024-05-28 21:56:01,410][Node][DEBUG] Received some message from 10 with CHANNEL: CONNECT
[2024-05-28 21:56:01,410][Node][DEBUG] Received HELLO from 10
[2024-05-28 21:56:01,410][Node][DEBUG] Waiting HELLO from 1
[2024-05-28 21:56:01,411][Node][DEBUG] Received some message from 10 with CHANNEL: DPSGD
[2024-05-28 21:56:01,537][Node][DEBUG] Received some message from 1 with CHANNEL: CONNECT
[2024-05-28 21:56:01,537][Node][DEBUG] Received HELLO from 1
[2024-05-28 21:56:01,538][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,538][Sharing][DEBUG] Model sending this round: [-0.07285684  0.05323815 -0.03036245 ... -0.00220736  0.00926929
 -0.01193677]
[2024-05-28 21:56:01,538][TCP][DEBUG] 3 sent the message to 1.
[2024-05-28 21:56:01,539][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,539][TCP][DEBUG] 3 sent the message to 10.
[2024-05-28 21:56:01,540][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,540][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,540][DPSGDNode][DEBUG] Received Model from 10 of iteration 3
[2024-05-28 21:56:01,541][Node][DEBUG] Received some message from 1 with CHANNEL: DPSGD
[2024-05-28 21:56:01,541][DPSGDNode][DEBUG] Received Model from 1 of iteration 3
[2024-05-28 21:56:01,541][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,542][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,542][Sharing][DEBUG] Averaging model from neighbor 1 of iteration 3
[2024-05-28 21:56:01,543][Sharing][DEBUG] Averaging model from neighbor 10 of iteration 3
[2024-05-28 21:56:01,544][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,546][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,546][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,547][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,585][Training][DEBUG] Round: 1 loss: 2.355785608291626
[2024-05-28 21:56:01,608][Training][DEBUG] Round: 2 loss: 2.5428186655044556
[2024-05-28 21:56:01,637][Training][DEBUG] Round: 3 loss: 2.6691929499308267
[2024-05-28 21:56:01,638][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,638][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,639][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,639][Node][DEBUG] Received some message from 2 with CHANNEL: CONNECT
[2024-05-28 21:56:01,647][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,647][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {2}
[2024-05-28 21:56:01,650][Node][DEBUG] Sending connection request to 2
[2024-05-28 21:56:01,651][TCP][DEBUG] Connecting to my neighbour: 2
[2024-05-28 21:56:01,652][TCP][DEBUG] 3 sent the message to 2.
[2024-05-28 21:56:01,652][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,655][Node][DEBUG] Waiting HELLO from 2
[2024-05-28 21:56:01,655][Node][DEBUG] Received HELLO from 2
[2024-05-28 21:56:01,655][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,656][Sharing][DEBUG] Model sending this round: [-0.07357727  0.05263031 -0.03086894 ... -0.00435598  0.00652868
 -0.01258987]
[2024-05-28 21:56:01,656][TCP][DEBUG] 3 sent the message to 2.
[2024-05-28 21:56:01,657][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,657][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,660][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,661][DPSGDNode][DEBUG] Received Model from 2 of iteration 4
[2024-05-28 21:56:01,662][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,662][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,663][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 4
[2024-05-28 21:56:01,667][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,667][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,667][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,667][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,698][Training][DEBUG] Round: 1 loss: 2.600712776184082
[2024-05-28 21:56:01,727][Training][DEBUG] Round: 2 loss: 2.623326063156128
[2024-05-28 21:56:01,755][Training][DEBUG] Round: 3 loss: 2.5564489364624023
[2024-05-28 21:56:01,755][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,755][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,755][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,755][Node][DEBUG] Received some message from 2 with CHANNEL: DPSGD
[2024-05-28 21:56:01,756][Node][DEBUG] Received some message from 10 with CHANNEL: DPSGD
[2024-05-28 21:56:01,756][Node][DEBUG] Received some message from 9 with CHANNEL: CONNECT
[2024-05-28 21:56:01,772][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,773][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {9, 2, 10}
[2024-05-28 21:56:01,778][Node][DEBUG] Sending connection request to 9
[2024-05-28 21:56:01,779][TCP][DEBUG] Connecting to my neighbour: 9
[2024-05-28 21:56:01,779][TCP][DEBUG] 3 sent the message to 9.
[2024-05-28 21:56:01,779][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,780][Node][DEBUG] Waiting HELLO from 9
[2024-05-28 21:56:01,781][Node][DEBUG] Received HELLO from 9
[2024-05-28 21:56:01,781][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,781][Sharing][DEBUG] Model sending this round: [-0.07333259  0.05295395 -0.03039015 ... -0.00503542  0.00905694
 -0.01293712]
[2024-05-28 21:56:01,782][TCP][DEBUG] 3 sent the message to 9.
[2024-05-28 21:56:01,782][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,782][TCP][DEBUG] 3 sent the message to 2.
[2024-05-28 21:56:01,782][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,783][TCP][DEBUG] 3 sent the message to 10.
[2024-05-28 21:56:01,783][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,783][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,783][DPSGDNode][DEBUG] Received Model from 2 of iteration 5
[2024-05-28 21:56:01,783][DPSGDNode][DEBUG] Received Model from 10 of iteration 5
[2024-05-28 21:56:01,784][Node][DEBUG] Received some message from 9 with CHANNEL: DPSGD
[2024-05-28 21:56:01,784][DPSGDNode][DEBUG] Received Model from 9 of iteration 5
[2024-05-28 21:56:01,784][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,784][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,784][Sharing][DEBUG] Averaging model from neighbor 9 of iteration 5
[2024-05-28 21:56:01,784][Sharing][DEBUG] Averaging model from neighbor 2 of iteration 5
[2024-05-28 21:56:01,784][Sharing][DEBUG] Averaging model from neighbor 10 of iteration 5
[2024-05-28 21:56:01,785][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,785][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,785][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,785][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,816][Training][DEBUG] Round: 1 loss: 2.3702354431152344
[2024-05-28 21:56:01,841][Training][DEBUG] Round: 2 loss: 2.3224133253097534
[2024-05-28 21:56:01,869][Training][DEBUG] Round: 3 loss: 2.319789171218872
[2024-05-28 21:56:01,871][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,871][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,871][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,888][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,888][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,893][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,893][Sharing][DEBUG] Model sending this round: [-0.07280773  0.05274914 -0.03098339 ... -0.00457051  0.0079281
 -0.01077925]
[2024-05-28 21:56:01,894][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,894][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,894][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,895][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,895][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,895][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,896][DPSGDNode][INFO] Starting training iteration: 7
[2024-05-28 21:56:01,931][Training][DEBUG] Round: 1 loss: 2.4378466606140137
[2024-05-28 21:56:01,957][Training][DEBUG] Round: 2 loss: 2.384039878845215
[2024-05-28 21:56:01,990][Training][DEBUG] Round: 3 loss: 2.2740317980448403
[2024-05-28 21:56:01,990][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,990][TCP][DEBUG] 3 sent the message to -1.
[2024-05-28 21:56:01,990][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,995][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,995][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,996][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,997][Sharing][DEBUG] Model sending this round: [-0.07256778  0.05318831 -0.03044545 ... -0.00209213  0.00751895
 -0.01273693]
[2024-05-28 21:56:01,997][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,997][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,997][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,997][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,997][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,997][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,999][DPSGDNode][INFO] Starting training iteration: 8
