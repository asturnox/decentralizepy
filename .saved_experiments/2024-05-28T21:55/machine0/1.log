[2024-05-28 21:55:56,160][DPSGDNode][DEBUG] Rank: 1
[2024-05-28 21:55:56,163][DPSGDNode][DEBUG] type(graph): <class 'int'>
[2024-05-28 21:55:56,163][DPSGDNode][DEBUG] type(mapping): <class 'decentralizepy.mappings.Linear.Linear'>
[2024-05-28 21:55:57,468][CIFAR10][INFO] Loading training set.
[2024-05-28 21:55:59,715][CIFAR10][DEBUG] Size fractions: [0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08332, 0.08347999999999994]
[2024-05-28 21:55:59,744][CIFAR10][INFO] Loading testing set.
[2024-05-28 21:56:00,596][CIFAR10][INFO] Extracting the validation set from the test set.
[2024-05-28 21:56:00,597][Node][INFO] Dataset instantiation complete.
[2024-05-28 21:56:00,680][Node][DEBUG] Sending connection request to 11
[2024-05-28 21:56:00,680][TCP][DEBUG] Connecting to my neighbour: 11
[2024-05-28 21:56:00,681][TCP][DEBUG] 1 sent the message to 11.
[2024-05-28 21:56:00,681][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,681][Node][DEBUG] Waiting HELLO from 11
[2024-05-28 21:56:00,721][Node][DEBUG] Received some message from -1 with CHANNEL: CONNECT
[2024-05-28 21:56:00,721][Node][DEBUG] Received HELLO from -1
[2024-05-28 21:56:00,721][Node][DEBUG] Waiting HELLO from 11
[2024-05-28 21:56:00,755][Node][DEBUG] Received some message from 11 with CHANNEL: CONNECT
[2024-05-28 21:56:00,755][Node][DEBUG] Received HELLO from 11
[2024-05-28 21:56:00,755][DPSGDWithPeerSampler][INFO] Each proc uses 1 threads out of 10.
[2024-05-28 21:56:00,755][Node][DEBUG] Sending connection request to -1
[2024-05-28 21:56:00,756][TCP][DEBUG] Connecting to my neighbour: -1
[2024-05-28 21:56:00,758][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:00,758][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:00,759][DPSGDNode][INFO] Starting training iteration: 0
[2024-05-28 21:56:00,799][Training][DEBUG] Round: 1 loss: 2.394990921020508
[2024-05-28 21:56:00,818][Training][DEBUG] Round: 2 loss: 3.2675397396087646
[2024-05-28 21:56:00,843][Training][DEBUG] Round: 3 loss: 3.1814185778299966
[2024-05-28 21:56:00,843][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:00,844][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:00,844][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:00,881][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:00,881][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {11}
[2024-05-28 21:56:00,881][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:00,886][Sharing][DEBUG] Model sending this round: [-0.07351512  0.05274981 -0.0306072  ... -0.00504945  0.00827257
 -0.01087687]
[2024-05-28 21:56:00,889][TCP][DEBUG] 1 sent the message to 11.
[2024-05-28 21:56:00,889][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:00,889][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,135][Node][DEBUG] Received some message from 11 with CHANNEL: DPSGD
[2024-05-28 21:56:01,135][DPSGDNode][DEBUG] Received Model from 11 of iteration 0
[2024-05-28 21:56:01,135][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,135][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,135][Sharing][DEBUG] Averaging model from neighbor 11 of iteration 0
[2024-05-28 21:56:01,136][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,137][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,137][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,138][DPSGDNode][INFO] Starting training iteration: 1
[2024-05-28 21:56:01,195][Training][DEBUG] Round: 1 loss: 2.615795612335205
[2024-05-28 21:56:01,219][Training][DEBUG] Round: 2 loss: 2.9517717361450195
[2024-05-28 21:56:01,259][Training][DEBUG] Round: 3 loss: 2.9066712061564126
[2024-05-28 21:56:01,260][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,261][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:01,262][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,275][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,275][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,275][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,281][Sharing][DEBUG] Model sending this round: [-0.0737621   0.05246286 -0.03100659 ... -0.00462191  0.00667989
 -0.01189712]
[2024-05-28 21:56:01,281][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,281][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,281][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,282][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,282][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,282][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,283][DPSGDNode][INFO] Starting training iteration: 2
[2024-05-28 21:56:01,308][Training][DEBUG] Round: 1 loss: 2.7362818717956543
[2024-05-28 21:56:01,334][Training][DEBUG] Round: 2 loss: 2.497453808784485
[2024-05-28 21:56:01,378][Training][DEBUG] Round: 3 loss: 2.512430508931478
[2024-05-28 21:56:01,378][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,379][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:01,380][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,382][Node][DEBUG] Received some message from 3 with CHANNEL: CONNECT
[2024-05-28 21:56:01,391][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,391][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,396][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,396][Sharing][DEBUG] Model sending this round: [-0.07416931  0.05191101 -0.03126115 ... -0.0064502   0.00942343
 -0.01228957]
[2024-05-28 21:56:01,396][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,396][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,396][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,397][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,397][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,397][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,398][DPSGDNode][INFO] Starting training iteration: 3
[2024-05-28 21:56:01,419][Training][DEBUG] Round: 1 loss: 2.999964714050293
[2024-05-28 21:56:01,457][Training][DEBUG] Round: 2 loss: 2.694229006767273
[2024-05-28 21:56:01,480][Training][DEBUG] Round: 3 loss: 2.799457550048828
[2024-05-28 21:56:01,481][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,481][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:01,481][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,531][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,531][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {3}
[2024-05-28 21:56:01,531][Node][DEBUG] Sending connection request to 3
[2024-05-28 21:56:01,531][TCP][DEBUG] Connecting to my neighbour: 3
[2024-05-28 21:56:01,533][TCP][DEBUG] 1 sent the message to 3.
[2024-05-28 21:56:01,533][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,533][Node][DEBUG] Waiting HELLO from 3
[2024-05-28 21:56:01,533][Node][DEBUG] Received HELLO from 3
[2024-05-28 21:56:01,533][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,534][Sharing][DEBUG] Model sending this round: [-0.07392613  0.05204472 -0.031284   ... -0.00464031  0.00614892
 -0.00837558]
[2024-05-28 21:56:01,535][TCP][DEBUG] 1 sent the message to 3.
[2024-05-28 21:56:01,535][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,535][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,540][Node][DEBUG] Received some message from 3 with CHANNEL: DPSGD
[2024-05-28 21:56:01,542][DPSGDNode][DEBUG] Received Model from 3 of iteration 3
[2024-05-28 21:56:01,543][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,543][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,543][Sharing][DEBUG] Averaging model from neighbor 3 of iteration 3
[2024-05-28 21:56:01,545][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,545][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,545][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,547][DPSGDNode][INFO] Starting training iteration: 4
[2024-05-28 21:56:01,641][Training][DEBUG] Round: 1 loss: 2.509791851043701
[2024-05-28 21:56:01,673][Training][DEBUG] Round: 2 loss: 2.316590428352356
[2024-05-28 21:56:01,703][Training][DEBUG] Round: 3 loss: 2.4142448902130127
[2024-05-28 21:56:01,704][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,705][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:01,705][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,706][Node][DEBUG] Received some message from 4 with CHANNEL: CONNECT
[2024-05-28 21:56:01,724][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,725][DPSGDWithPeerSampler][DEBUG] Neighbors this round: set()
[2024-05-28 21:56:01,728][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,731][Sharing][DEBUG] Model sending this round: [-0.07328064  0.05267916 -0.03044809 ... -0.00502407  0.00638884
 -0.0133121 ]
[2024-05-28 21:56:01,731][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,731][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,731][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,731][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,732][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,732][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,733][DPSGDNode][INFO] Starting training iteration: 5
[2024-05-28 21:56:01,750][Training][DEBUG] Round: 1 loss: 3.0025854110717773
[2024-05-28 21:56:01,774][Training][DEBUG] Round: 2 loss: 2.8285484313964844
[2024-05-28 21:56:01,802][Training][DEBUG] Round: 3 loss: 2.8525776863098145
[2024-05-28 21:56:01,803][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,803][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:01,803][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,825][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,825][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {4}
[2024-05-28 21:56:01,830][Node][DEBUG] Sending connection request to 4
[2024-05-28 21:56:01,830][TCP][DEBUG] Connecting to my neighbour: 4
[2024-05-28 21:56:01,832][TCP][DEBUG] 1 sent the message to 4.
[2024-05-28 21:56:01,833][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,835][Node][DEBUG] Waiting HELLO from 4
[2024-05-28 21:56:01,835][Node][DEBUG] Received HELLO from 4
[2024-05-28 21:56:01,835][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,835][Sharing][DEBUG] Model sending this round: [-0.07310397  0.05293361 -0.03018291 ... -0.00418617  0.0060657
 -0.01187259]
[2024-05-28 21:56:01,836][TCP][DEBUG] 1 sent the message to 4.
[2024-05-28 21:56:01,836][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,837][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:01,856][Node][DEBUG] Received some message from 4 with CHANNEL: DPSGD
[2024-05-28 21:56:01,856][DPSGDNode][DEBUG] Received Model from 4 of iteration 5
[2024-05-28 21:56:01,857][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:01,857][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:01,857][Sharing][DEBUG] Averaging model from neighbor 4 of iteration 5
[2024-05-28 21:56:01,859][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:01,859][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:01,860][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:01,862][DPSGDNode][INFO] Starting training iteration: 6
[2024-05-28 21:56:01,891][Training][DEBUG] Round: 1 loss: 2.382028579711914
[2024-05-28 21:56:01,942][Training][DEBUG] Round: 2 loss: 2.473253846168518
[2024-05-28 21:56:01,966][Training][DEBUG] Round: 3 loss: 2.422550598780314
[2024-05-28 21:56:01,967][DPSGDWithPeerSampler][DEBUG] Requesting neighbors from the peer sampler.
[2024-05-28 21:56:01,968][TCP][DEBUG] 1 sent the message to -1.
[2024-05-28 21:56:01,969][TCP][DEBUG] Sent message size: 79
[2024-05-28 21:56:01,969][Node][DEBUG] Received some message from 10 with CHANNEL: CONNECT
[2024-05-28 21:56:01,979][Node][DEBUG] Received some message from -1 with CHANNEL: PEERS
[2024-05-28 21:56:01,979][DPSGDWithPeerSampler][DEBUG] Neighbors this round: {10}
[2024-05-28 21:56:01,979][Node][DEBUG] Sending connection request to 10
[2024-05-28 21:56:01,979][TCP][DEBUG] Connecting to my neighbour: 10
[2024-05-28 21:56:01,981][TCP][DEBUG] 1 sent the message to 10.
[2024-05-28 21:56:01,981][TCP][DEBUG] Sent message size: 46
[2024-05-28 21:56:01,982][Node][DEBUG] Waiting HELLO from 10
[2024-05-28 21:56:01,982][Node][DEBUG] Received HELLO from 10
[2024-05-28 21:56:01,982][DPSGDNode][DEBUG] Connected to all neighbors
[2024-05-28 21:56:01,985][Sharing][DEBUG] Model sending this round: [-0.07311141  0.05287993 -0.03064451 ... -0.00374519  0.00502551
 -0.01165588]
[2024-05-28 21:56:01,988][TCP][DEBUG] 1 sent the message to 10.
[2024-05-28 21:56:01,988][TCP][DEBUG] Sent message size: 359554
[2024-05-28 21:56:01,988][DPSGDNode][DEBUG] Sent to all neighbors
[2024-05-28 21:56:02,012][Node][DEBUG] Received some message from 10 with CHANNEL: DPSGD
[2024-05-28 21:56:02,012][DPSGDNode][DEBUG] Received Model from 10 of iteration 6
[2024-05-28 21:56:02,012][DPSGDNode][DEBUG] Received from all
[2024-05-28 21:56:02,012][DPSGDNode][DEBUG] Averaging
[2024-05-28 21:56:02,013][Sharing][DEBUG] Averaging model from neighbor 10 of iteration 6
[2024-05-28 21:56:02,013][DPSGDNode][DEBUG] Finished averaging
[2024-05-28 21:56:02,015][DPSGDNode][DEBUG] resetting optimizer
[2024-05-28 21:56:02,015][DPSGDNode][DEBUG] Finished resetting optimizer
[2024-05-28 21:56:02,016][DPSGDNode][INFO] Starting training iteration: 7
